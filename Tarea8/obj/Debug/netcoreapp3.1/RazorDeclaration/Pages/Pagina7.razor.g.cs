// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Tarea8.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Tarea8;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Tarea8.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using System.Net;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Radzen;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/_Imports.razor"
using Radzen.Blazor;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/pagina7")]
    public partial class Pagina7 : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 113 "/home/elmer/Desktop/tareas_de_p3/Tarea8/Tarea8/Pages/Pagina7.razor"
       
    
    [Inject]
    IJSRuntime JS { get; set; }
    private Vacuna[] Vacunas;
    private string VacunaNueva;
    private int VacunaCantidad;
    private List<string> Provincias = new List<string>() { "Azua", "Bahoruco", "Barahona", "Dajabón", "Distrito Nacional", "Duarte", "Elías Piña", "El Seibo", "Espaillat", "Hato Mayor", "Hermanas Mirabal", "Independencia", "La Altagracia", "La Romana", "La Vega", "María Trinidad Sánchez", "Monseñor Nouel", "Monte Cristi", "Monte Plata", "Pedernales", "Peravia", "Puerto Plata", "Samaná", "Sánchez Ramírez", "San Cristóbal", "San José de Ocoa", "San Juan", "San Pedro de Macorís", "Santiago", "Santiago Rodríguez", "Santo Domingo", "Valverde" };
    private Provincia[] ProvinciasAPI;
    private string ProvinciaSeleccionada;
    private int Counter = 1;

    protected override async Task OnInitializedAsync()
    {
        await GetVacunas();
        await GetProvincias();
    }

    public void IncreaseCount()
    {
        Counter++;
    }

    public async Task SetProvincia()
    {
        if (ProvinciaSeleccionada != "Elija su provincia" || ProvinciaSeleccionada != null)
        {
            var pos = Provincias.IndexOf(ProvinciaSeleccionada) + 1;
            var api = $"https://api-vacuna.herokuapp.com/api/Modificar_Pro/{ProvinciaSeleccionada}/{pos}";
            WebClient cliente = new WebClient();
            var datos = await cliente.DownloadStringTaskAsync(new Uri(api));
            var result = JsonConvert.DeserializeObject<Result>(datos);

            await JS.InvokeAsync<object>("alert", result.mensaje);
            await GetProvincias();
        }
        else
        {
            await JS.InvokeAsync<object>("alert", "Debe seleccionar una provincia");
        }
    }

    public async Task SetVacuna()
    {
        if (VacunaNueva != null && VacunaCantidad > 0)
        {
            var api = $"https://api-vacuna.herokuapp.com/api/Registrar_v/{VacunaNueva}/{VacunaCantidad}";
            WebClient cliente = new WebClient();
            var datos = await cliente.DownloadStringTaskAsync(new Uri(api));
            var result = JsonConvert.DeserializeObject<Result>(datos);

            await JS.InvokeAsync<object>("alert", result.mensaje);
            await GetVacunas();
        }
        else
        {
            await JS.InvokeAsync<object>("alert", "Debe completar los campos correctamente");
        }
    }

    public async Task GetProvincias()
    {
        var api = $"https://api-vacuna.herokuapp.com/api/Provinvias";
        WebClient cliente = new WebClient();
        var datos = await cliente.DownloadStringTaskAsync(new Uri(api));
        ProvinciasAPI = JsonConvert.DeserializeObject<Provincia[]>(datos);
    }

    public async Task GetVacunas()
    {
        var api = $"https://api-vacuna.herokuapp.com/api/Vacunas";
        WebClient cliente = new WebClient();
        var datos = await cliente.DownloadStringTaskAsync(new Uri(api));
        Vacunas= JsonConvert.DeserializeObject<Vacuna[]>(datos);
    }

    public class Provincia
    {
        public string NOMBRE { get; set; }
    }

    public class Vacuna
    {
        public string MARCA { get; set; }
    }

    public class Result
    {
        public string mensaje { get; set; }
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
